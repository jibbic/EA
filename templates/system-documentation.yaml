# System Documentation Template
# För dokumentation av ett komplett system enligt NIS 2-krav

system:
  # ============================================================================
  # GRUNDLÄGGANDE INFORMATION
  # ============================================================================
  
  basic_info:
    id: "sys-[unique-id]"
    name: "System Name"
    description: |
      Detaljerad beskrivning av systemet, dess syfte och funktioner.
      Beskriv vad systemet gör och varför det finns.
    
    system_type: # välj en
      - business_application
      - infrastructure_service
      - integration_platform
      - database
      - other
    
    aliases: []  # Andra namn systemet är känt som
    version: "x.y.z"
    deployment_date: "YYYY-MM-DD"
    lifecycle_status: # välj en
      - planning
      - development
      - production
      - maintenance
      - retirement
    
  # ============================================================================
  # KRITIKALITET OCH KLASSIFICERING
  # ============================================================================
  
  classification:
    criticality: # välj en, baserat på BIA
      - critical    # RTO < 4h, affärskritisk
      - high        # RTO 4-24h, viktigt för verksamheten
      - medium      # RTO 24-72h, stödjer verksamhet
      - low         # RTO > 72h, kan vänta
    
    data_classification: # högsta klassificering av data i systemet
      - public           # Publik information
      - internal         # Intern, ej publik
      - confidential     # Konfidentiell, begränsad åtkomst
      - secret           # Hemlig, mycket begränsad åtkomst
    
    contains_personal_data: true/false
    contains_sensitive_personal_data: true/false  # GDPR special categories
    
    # Business Impact (från BIA)
    recovery_time_objective: "4h"    # Maximal acceptabel downtime
    recovery_point_objective: "1h"   # Maximal acceptabel dataförlust
    
    financial_impact_per_hour: "10000 EUR"
    regulatory_impact: "high/medium/low"
    reputational_impact: "critical/high/medium/low"

  # ============================================================================
  # ANSVAR OCH ÄGANDE
  # ============================================================================
  
  ownership:
    business_owner:
      person_id: "person-xxx"
      name: "Namn Namnsson"
      email: "namn@company.com"
      organizational_unit: "org-unit-xxx"
    
    technical_custodian:
      person_id: "person-yyy"
      name: "Tech Person"
      email: "tech@company.com"
      organizational_unit: "org-unit-it"
    
    backup_contacts:
      - person_id: "person-zzz"
        role: "Backup custodian"
    
    responsible_team: "IT Operations Team"
    escalation_contact: "on-call-team@company.com"

  # ============================================================================
  # VERKSAMHETSKOPPLING
  # ============================================================================
  
  business_context:
    supports_capabilities:
      - capability_id: "cap-001"
        capability_name: "Customer Service"
    
    supports_processes:
      - process_id: "proc-001"
        process_name: "Handle customer support ticket"
        dependency_type: "critical"  # critical/high/medium/low
    
    user_groups:
      - group_name: "Customer Service Agents"
        user_count: 150
        access_type: "daily intensive"
      
      - group_name: "Customers"
        user_count: 50000
        access_type: "occasional"

  # ============================================================================
  # TEKNISK ARKITEKTUR
  # ============================================================================
  
  technical_architecture:
    
    components:
      - component_id: "comp-001"
        name: "Frontend Web Application"
        component_type: "frontend"
        technology_stack:
          - "React 18"
          - "TypeScript"
          - "Nginx"
        hosted_on: "infra-web-server-01"
      
      - component_id: "comp-002"
        name: "Backend API"
        component_type: "backend"
        technology_stack:
          - "Java Spring Boot"
          - "PostgreSQL"
        hosted_on: "infra-app-server-01"
    
    infrastructure:
      hosting_type: # välj en
        - on_premise
        - cloud
        - hybrid
      
      cloud_provider: "AWS"  # om cloud eller hybrid
      cloud_region: "eu-north-1"
      
      servers:
        - node_id: "infra-web-server-01"
          node_type: "virtual_machine"
          operating_system: "Ubuntu 22.04 LTS"
          location: "Stockholm Datacenter"
          
        - node_id: "infra-app-server-01"
          node_type: "container"
          platform: "Kubernetes"
          location: "AWS eu-north-1"
      
      network:
        - network_id: "net-dmz"
          security_zone: "dmz"
          ip_range: "10.1.0.0/24"
    
    technology_platforms:
      - platform_id: "platform-001"
        name: "PostgreSQL"
        version: "14.5"
        support_end_date: "2026-11-12"
        vendor: "supplier-postgres"
    
    integrations:
      - interface_id: "if-001"
        name: "Integration to CRM"
        target_system: "app-crm"
        interface_type: "api"
        protocol: "REST over HTTPS"
        authentication_method: "OAuth 2.0"
        encryption: true
        data_classification: "confidential"
        
      - interface_id: "if-002"
        name: "Database connection"
        target_system: "db-customer-data"
        interface_type: "database"
        protocol: "PostgreSQL wire protocol"
        authentication_method: "Certificate-based"
        encryption: true

  # ============================================================================
  # SÄKERHET
  # ============================================================================
  
  security:
    
    # Autentisering & Auktorisering
    authentication:
      method: "SSO with MFA"  # Beskriv autentiseringsmetod
      identity_provider: "Azure AD"
      mfa_enabled: true
      mfa_coverage: "100% of users"
    
    authorization:
      model: "RBAC"  # RBAC, ABAC, etc.
      roles:
        - "Admin"
        - "User"
        - "ReadOnly"
    
    # Säkerhetskontroller som skyddar systemet
    protected_by_controls:
      - control_id: "ctrl-001"
        control_name: "WAF Protection"
        control_type: "preventive"
        
      - control_id: "ctrl-002"
        control_name: "MFA for all access"
        control_type: "preventive"
        
      - control_id: "ctrl-003"
        control_name: "SIEM Monitoring"
        control_type: "detective"
        
      - control_id: "ctrl-004"
        control_name: "Daily Backup"
        control_type: "corrective"
    
    # Kryptering
    encryption:
      at_rest:
        enabled: true
        method: "AES-256"
        key_management: "AWS KMS"
      
      in_transit:
        enabled: true
        method: "TLS 1.3"
        certificate_authority: "Let's Encrypt"
    
    # Senaste säkerhetsgenomgång
    last_security_review:
      date: "2026-01-15"
      type: "Penetration Test"
      performed_by: "External Security Firm"
      findings: "3 medium, 5 low"
      all_findings_resolved: true
      next_review: "2027-01-15"
    
    # Sårbarheter (aktuella)
    known_vulnerabilities:
      - vulnerability_id: "vuln-001"
        severity: "medium"
        status: "in_progress"
        remediation_deadline: "2026-03-01"
    
    # Hot mot systemet
    threat_landscape:
      - threat_id: "threat-ransomware"
        threat_name: "Ransomware attack"
        likelihood: "medium"
        impact: "critical"
        mitigation_status: "mitigated"

  # ============================================================================
  # DATA
  # ============================================================================
  
  data:
    
    data_objects_processed:
      - data_object_id: "data-customer-info"
        data_name: "Customer Personal Information"
        classification: "confidential"
        personal_data: true
        data_categories:
          - "Name, email, phone"
          - "Address"
        
      - data_object_id: "data-support-tickets"
        data_name: "Support Ticket Data"
        classification: "internal"
        personal_data: false
    
    data_stores:
      - datastore_id: "db-001"
        name: "Customer Database"
        store_type: "database"
        hosting: "infra-db-server-01"
        encryption_at_rest: true
        backup_configured: true
        backup_frequency: "24h"
        backup_retention: "30 days"
        access_controls: true
    
    data_flows:
      - dataflow_id: "flow-001"
        name: "Customer data to CRM"
        source: "app-support-system"
        target: "app-crm"
        data_objects:
          - "data-customer-info"
        encryption_in_transit: true
        crosses_trust_boundary: true
        authentication_required: true

  # ============================================================================
  # DRIFT OCH UNDERHÅLL
  # ============================================================================
  
  operations:
    
    # Tillgänglighet
    availability:
      target_uptime: "99.5%"
      maintenance_window: "Sunday 02:00-06:00 CET"
      support_hours: "24/7"
      on_call_available: true
    
    # Backup och Recovery
    backup:
      backup_configured: true
      backup_frequency: "Daily"
      backup_type: "Full + Incremental"
      backup_location: "AWS S3 eu-west-1"
      backup_encryption: true
      last_backup_test: "2026-02-01"
      restore_tested: true
      backup_retention_policy: "30 days online, 1 year archive"
    
    # Patch Management
    patch_management:
      patch_schedule: "Monthly"
      last_patched: "2026-02-01"
      patch_status: "up_to_date"
      pending_patches: 0
      emergency_patch_process: "documented"
    
    # Monitoring
    monitoring:
      monitoring_enabled: true
      monitoring_tools:
        - "Prometheus"
        - "Grafana"
        - "SIEM"
      monitored_metrics:
        - "Availability"
        - "Response time"
        - "Error rate"
        - "Security events"
      alert_recipients:
        - "ops-team@company.com"
        - "on-call"
    
    # Change Management
    change_management:
      change_process: "ITIL Change Management"
      change_approval_required: true
      change_advisory_board: "IT CAB"
      emergency_change_process: "documented"

  # ============================================================================
  # LEVERANTÖRER
  # ============================================================================
  
  vendors:
    
    primary_vendor:
      supplier_id: "supplier-001"
      name: "Software Vendor AB"
      supplier_type: "software_vendor"
      criticality: "high"
      contract_end_date: "2027-12-31"
      support_level: "24/7 Premium Support"
      security_assessment_date: "2025-11-01"
      security_rating: "approved"
    
    other_suppliers:
      - supplier_id: "supplier-002"
        name: "Cloud Provider"
        supplier_type: "cloud_provider"
        services: "Infrastructure hosting"

  # ============================================================================
  # COMPLIANCE
  # ============================================================================
  
  compliance:
    
    applicable_regulations:
      - "NIS 2 Directive"
      - "GDPR"
      - "ISO 27001"
    
    compliance_requirements:
      - requirement_id: "comp-req-nis2-21-2-a"
        requirement: "Incident handling"
        status: "compliant"
        evidence:
          - "Incident response integrated with SIEM"
          - "24/7 monitoring"
      
      - requirement_id: "comp-req-gdpr-32"
        requirement: "Security of processing"
        status: "compliant"
        evidence:
          - "Encryption at rest and transit"
          - "Access controls with MFA"
          - "Regular security assessments"
    
    last_compliance_audit:
      date: "2025-12-01"
      auditor: "External Audit Firm"
      result: "Compliant"
      findings: "2 minor observations"
      next_audit: "2026-12-01"

  # ============================================================================
  # INCIDENTER OCH PROBLEM
  # ============================================================================
  
  incident_history:
    
    - incident_id: "inc-001"
      date: "2025-10-15"
      type: "Service outage"
      severity: "high"
      duration: "3h"
      root_cause: "Database connection pool exhaustion"
      impact: "Service unavailable for all users"
      resolution: "Increased connection pool size"
      preventive_actions: "Implemented connection monitoring"

  # ============================================================================
  # KONTINUITETSPLANERING
  # ============================================================================
  
  business_continuity:
    
    disaster_recovery_plan:
      plan_exists: true
      plan_location: "Confluence DR-Plans"
      last_updated: "2026-01-15"
      last_tested: "2025-12-10"
      test_result: "Successful"
      rto_met_in_test: true
      rpo_met_in_test: true
    
    recovery_procedures:
      - step: "Activate DR site"
        responsible: "IT Operations"
        estimated_duration: "30min"
      
      - step: "Restore database from backup"
        responsible: "Database Admin"
        estimated_duration: "2h"
      
      - step: "Switch DNS to DR"
        responsible: "Network Team"
        estimated_duration: "15min"
    
    alternate_processes:
      manual_workaround_available: true
      manual_process_description: "Customer support via phone only"
      manual_process_capacity: "50% of normal capacity"

  # ============================================================================
  # DOKUMENTATION OCH LÄNKAR
  # ============================================================================
  
  documentation:
    
    technical_documentation:
      - type: "Architecture Diagram"
        location: "https://wiki.company.com/system-arch"
      
      - type: "API Documentation"
        location: "https://api-docs.company.com/"
      
      - type: "User Manual"
        location: "https://docs.company.com/user-guide"
      
      - type: "Operations Runbook"
        location: "https://wiki.company.com/runbook"
    
    policies_and_procedures:
      - "Incident Response Procedure"
      - "Change Management Procedure"
      - "Backup and Recovery Procedure"
    
    related_systems:
      depends_on:
        - system_id: "app-crm"
          dependency_type: "critical"
          
        - system_id: "sys-active-directory"
          dependency_type: "critical"
      
      dependencies:
        - system_id: "app-reporting"
          dependency_type: "medium"

  # ============================================================================
  # METADATA
  # ============================================================================
  
  metadata:
    created_at: "2025-01-10T10:00:00Z"
    created_by: "person-xxx"
    last_updated: "2026-02-26T14:30:00Z"
    last_modified_by: "person-yyy"
    documentation_version: "2.1"
    tags:
      - "customer-facing"
      - "high-availability"
      - "gdpr-relevant"
